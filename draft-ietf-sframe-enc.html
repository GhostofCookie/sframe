<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Secure Frame (SFrame)</title>
<meta content="Emad Omara" name="author">
<meta content="Justin Uberti" name="author">
<meta content="Sergio Garcia Murillo" name="author">
<meta content="Richard L. Barnes" name="author">
<meta content="Youenn Fablet" name="author">
<meta content="
       This document describes the Secure Frame (SFrame) end-to-end encryption and
authentication mechanism for media frames in a multiparty conference call, in
which central media servers (selective forwarding units or SFUs) can access the
media metadata needed to make forwarding decisions without having access to the
actual media. 
       The proposed mechanism differs from the Secure Real-Time Protocol (SRTP) in that
it is independent of RTP (thus compatible with non-RTP media transport) and can
be applied to whole media frames in order to be more bandwidth efficient. 
    " name="description">
<meta content="xml2rfc 3.16.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-sframe-enc-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.16.0
    Python 3.10.10
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.2
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.1
    setuptools 65.6.0
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="draft-ietf-sframe-enc.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 8em !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SFrame</td>
<td class="right">March 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Omara, et al.</td>
<td class="center">Expires 14 September 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-sframe-enc-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-03-13" class="published">13 March 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-09-14">14 September 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">E. Omara</div>
<div class="org">Apple</div>
</div>
<div class="author">
      <div class="author-name">J. Uberti</div>
<div class="org">Google</div>
</div>
<div class="author">
      <div class="author-name">S. Murillo</div>
<div class="org">CoSMo Software</div>
</div>
<div class="author">
      <div class="author-name">R. L. Barnes, <span class="editor">Ed.</span>
</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">Y. Fablet</div>
<div class="org">Apple</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Secure Frame (SFrame)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the Secure Frame (SFrame) end-to-end encryption and
authentication mechanism for media frames in a multiparty conference call, in
which central media servers (selective forwarding units or SFUs) can access the
media metadata needed to make forwarding decisions without having access to the
actual media.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The proposed mechanism differs from the Secure Real-Time Protocol (SRTP) in that
it is independent of RTP (thus compatible with non-RTP media transport) and can
be applied to whole media frames in order to be more bandwidth efficient.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://sframe-wg.github.io/sframe/draft-ietf-sframe-enc.html">https://sframe-wg.github.io/sframe/draft-ietf-sframe-enc.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-sframe-enc/">https://datatracker.ietf.org/doc/draft-ietf-sframe-enc/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Secure Media Frames Working Group mailing list (<span><a href="mailto:sframe@ietf.org">mailto:sframe@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/sframe/">https://mailarchive.ietf.org/arch/browse/sframe/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/sframe/">https://www.ietf.org/mailman/listinfo/sframe/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/sframe-wg/sframe">https://github.com/sframe-wg/sframe</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 14 September 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-goals" class="internal xref">Goals</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-sframe" class="internal xref">SFrame</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-application-context" class="internal xref">Application Context</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-sframe-ciphertext" class="internal xref">SFrame Ciphertext</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-sframe-header" class="internal xref">SFrame Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-encryption-schema" class="internal xref">Encryption Schema</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-key-selection" class="internal xref">Key Selection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="auto internal xref">4.4.2</a>.  <a href="#name-key-derivation" class="internal xref">Key Derivation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a href="#section-4.4.3" class="auto internal xref">4.4.3</a>.  <a href="#name-encryption" class="internal xref">Encryption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.4">
                    <p id="section-toc.1-1.4.2.4.2.4.1"><a href="#section-4.4.4" class="auto internal xref">4.4.4</a>.  <a href="#name-decryption" class="internal xref">Decryption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.5">
                    <p id="section-toc.1-1.4.2.4.2.5.1"><a href="#section-4.4.5" class="auto internal xref">4.4.5</a>.  <a href="#name-duplicate-frames" class="internal xref">Duplicate Frames</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-ciphersuites" class="internal xref">Ciphersuites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="auto internal xref">4.5.1</a>.  <a href="#name-aes-ctr-with-sha2" class="internal xref">AES-CTR with SHA2</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-key-management" class="internal xref">Key Management</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-sender-keys" class="internal xref">Sender Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-mls" class="internal xref">MLS</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-media-considerations" class="internal xref">Media Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-sfu" class="internal xref">SFU</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-lastn-and-rtp-stream-reuse" class="internal xref">LastN and RTP stream reuse</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-simulcast" class="internal xref">Simulcast</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3">
                    <p id="section-toc.1-1.6.2.1.2.3.1"><a href="#section-6.1.3" class="auto internal xref">6.1.3</a>.  <a href="#name-svc" class="internal xref">SVC</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-video-key-frames" class="internal xref">Video Key Frames</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-partial-decoding" class="internal xref">Partial Decoding</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-no-per-sender-authenticatio" class="internal xref">No Per-Sender Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-key-management-2" class="internal xref">Key Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-authentication-tag-length" class="internal xref">Authentication tag length</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-overhead" class="internal xref">Overhead</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-audio" class="internal xref">Audio</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-video" class="internal xref">Video</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-sframe-vs-perc-lite" class="internal xref">SFrame vs PERC-lite</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3.2.1">
                    <p id="section-toc.1-1.11.2.3.2.1.1"><a href="#appendix-B.3.1" class="auto internal xref">B.3.1</a>.  <a href="#name-audio-2" class="internal xref">Audio</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3.2.2">
                    <p id="section-toc.1-1.11.2.3.2.2.1"><a href="#appendix-B.3.2" class="auto internal xref">B.3.2</a>.  <a href="#name-video-2" class="internal xref">Video</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-test-vectors" class="internal xref">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-aes_ctr_128_hmac_sha256_4" class="internal xref">AES_CTR_128_HMAC_SHA256_4</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-aes_ctr_128_hmac_sha256_8" class="internal xref">AES_CTR_128_HMAC_SHA256_8</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-aes_gcm_128_sha256" class="internal xref">AES_GCM_128_SHA256</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#appendix-C.4" class="auto internal xref">C.4</a>.  <a href="#name-aes_gcm_256_sha512" class="internal xref">AES_GCM_256_SHA512</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Modern multi-party video call systems use Selective Forwarding Unit (SFU)
servers to efficiently route RTP streams to call endpoints based on factors such
as available bandwidth, desired video size, codec support, and other factors. An
SFU typically does not need access to the media content of the conference,
allowing for the media to be "end-to-end" encrypted so that it cannot be
decrypted by the SFU. In order for the SFU to work properly, though, it usually
needs to be able to access RTP metadata and RTCP feedback messages, which is not
possible if all RTP/RTCP traffic is end-to-end encrypted.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">As such, two layers of encryptions and authentication are required:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-3">
<li id="section-1-3.1">Hop-by-hop (HBH) encryption of media, metadata, and feedback messages
between the the endpoints and SFU<a href="#section-1-3.1" class="pilcrow">¶</a>
</li>
        <li id="section-1-3.2">End-to-end (E2E) encryption of media between the endpoints<a href="#section-1-3.2" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-1-4">The Secure Real-Time Protocol (SRTP) is already widely used for HBH encryption
<span>[<a href="#RFC3711" class="cite xref">RFC3711</a>]</span>. The SRTP "double encryption" scheme defines a way to do E2E
encryption in SRTP <span>[<a href="#RFC8723" class="cite xref">RFC8723</a>]</span>. Unfortunately, this scheme has poor efficiency
and high complexity, and its entanglement with RTP makes it unworkable in
several realistic SFU scenarios.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">This document proposes a new end-to-end encryption mechanism known as SFrame,
specifically designed to work in group conference calls with SFUs. SFrame is a
general encryption framing that can be used to protect payloads sent over SRTP<a href="#section-1-5" class="pilcrow">¶</a></p>
<span id="name-srtp-packet-with-sframe-pro"></span><figure id="figure-1">
        <div id="section-1-6.1">
          <div class="alignLeft art-svg artwork" id="section-1-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="384" width="576" viewBox="0 0 576 384" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 8,208 L 8,368" fill="none" stroke="black"></path>
              <path d="M 32,32 L 32,336" fill="none" stroke="black"></path>
              <path d="M 64,32 L 64,64" fill="none" stroke="black"></path>
              <path d="M 80,32 L 80,64" fill="none" stroke="black"></path>
              <path d="M 96,32 L 96,64" fill="none" stroke="black"></path>
              <path d="M 160,32 L 160,64" fill="none" stroke="black"></path>
              <path d="M 176,32 L 176,64" fill="none" stroke="black"></path>
              <path d="M 200,208 L 200,240" fill="none" stroke="black"></path>
              <path d="M 288,32 L 288,64" fill="none" stroke="black"></path>
              <path d="M 544,32 L 544,336" fill="none" stroke="black"></path>
              <path d="M 568,32 L 568,368" fill="none" stroke="black"></path>
              <path d="M 32,32 L 568,32" fill="none" stroke="black"></path>
              <path d="M 32,64 L 544,64" fill="none" stroke="black"></path>
              <path d="M 32,96 L 544,96" fill="none" stroke="black"></path>
              <path d="M 32,126 L 544,126" fill="none" stroke="black"></path>
              <path d="M 32,130 L 544,130" fill="none" stroke="black"></path>
              <path d="M 32,176 L 544,176" fill="none" stroke="black"></path>
              <path d="M 8,208 L 544,208" fill="none" stroke="black"></path>
              <path d="M 32,240 L 200,240" fill="none" stroke="black"></path>
              <path d="M 8,304 L 568,304" fill="none" stroke="black"></path>
              <path d="M 32,336 L 544,336" fill="none" stroke="black"></path>
              <path d="M 8,368 L 32,368" fill="none" stroke="black"></path>
              <path d="M 544,368 L 568,368" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="560,304 548,298.4 548,309.6" fill="black" transform="rotate(180,552,304)"></polygon>
              <polygon class="arrowhead" points="560,32 548,26.4 548,37.6" fill="black" transform="rotate(180,552,32)"></polygon>
              <polygon class="arrowhead" points="32,304 20,298.4 20,309.6" fill="black" transform="rotate(0,24,304)"></polygon>
              <polygon class="arrowhead" points="32,208 20,202.4 20,213.6" fill="black" transform="rotate(0,24,208)"></polygon>
              <g class="text">
                <text x="48" y="52">V=2</text>
                <text x="72" y="52">P</text>
                <text x="88" y="52">X</text>
                <text x="124" y="52">CC</text>
                <text x="168" y="52">M</text>
                <text x="228" y="52">PT</text>
                <text x="380" y="52">sequence</text>
                <text x="444" y="52">number</text>
                <text x="288" y="84">timestamp</text>
                <text x="184" y="116">synchronization</text>
                <text x="276" y="116">source</text>
                <text x="332" y="116">(SSRC)</text>
                <text x="404" y="116">identifier</text>
                <text x="180" y="148">contributing</text>
                <text x="260" y="148">source</text>
                <text x="316" y="148">(CSRC)</text>
                <text x="392" y="148">identifiers</text>
                <text x="300" y="164">....</text>
                <text x="200" y="196">RTP</text>
                <text x="268" y="196">extension(s)</text>
                <text x="364" y="196">(OPTIONAL)</text>
                <text x="84" y="228">SFrame</text>
                <text x="140" y="228">header</text>
                <text x="140" y="276">SFrame</text>
                <text x="208" y="276">encrypted</text>
                <text x="264" y="276">and</text>
                <text x="336" y="276">authenticated</text>
                <text x="424" y="276">payload</text>
                <text x="212" y="324">SRTP</text>
                <text x="292" y="324">authentication</text>
                <text x="368" y="324">tag</text>
                <text x="60" y="372">SRTP</text>
                <text x="120" y="372">Encrypted</text>
                <text x="192" y="372">Portion</text>
                <text x="340" y="372">SRTP</text>
                <text x="416" y="372">Authenticated</text>
                <text x="504" y="372">Portion</text>
              </g>
            </svg><a href="#section-1-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-srtp-packet-with-sframe-pro" class="selfRef">SRTP packet with SFrame-protected payload</a>
        </figcaption></figure>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
"OPTIONAL" in this document are to be interpreted as described in
BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all
capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-2">
        <dt id="section-2-2.1">SFU:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.2">
          <p id="section-2-2.2.1">Selective Forwarding Unit (AKA RTP Switch)<a href="#section-2-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.3">IV:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.4">
          <p id="section-2-2.4.1">Initialization Vector<a href="#section-2-2.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.5">MAC:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.6">
          <p id="section-2-2.6.1">Message Authentication Code<a href="#section-2-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.7">E2EE:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.8">
          <p id="section-2-2.8.1">End to End Encryption<a href="#section-2-2.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.9">HBH:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.10">
          <p id="section-2-2.10.1">Hop By Hop<a href="#section-2-2.10.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="goals">
<section id="section-3">
      <h2 id="name-goals">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-goals" class="section-name selfRef">Goals</a>
      </h2>
<p id="section-3-1">SFrame is designed to be a suitable E2EE protection scheme for conference call
media in a broad range of scenarios, as outlined by the following goals:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3-2">
<li id="section-3-2.1">Provide an secure E2EE mechanism for audio and video in conference calls
that can be used with arbitrary SFU servers.<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-3-2.2">Decouple media encryption from key management to allow SFrame to be used
with an arbitrary key management system.<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-3-2.3">Minimize packet expansion to allow successful conferencing in as many
network conditions as possible.<a href="#section-3-2.3" class="pilcrow">¶</a>
</li>
        <li id="section-3-2.4">Independence from the underlying transport, including use in non-RTP
transports, e.g., WebTransport.<a href="#section-3-2.4" class="pilcrow">¶</a>
</li>
        <li id="section-3-2.5">When used with RTP and its associated error resilience mechanisms, i.e., RTX
and FEC, require no special handling for RTX and FEC packets.<a href="#section-3-2.5" class="pilcrow">¶</a>
</li>
        <li id="section-3-2.6">Minimize the changes needed in SFU servers.<a href="#section-3-2.6" class="pilcrow">¶</a>
</li>
        <li id="section-3-2.7">Minimize the changes needed in endpoints.<a href="#section-3-2.7" class="pilcrow">¶</a>
</li>
        <li id="section-3-2.8">Work with the most popular audio and video codecs used in conferencing
scenarios.<a href="#section-3-2.8" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="sframe">
<section id="section-4">
      <h2 id="name-sframe">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-sframe" class="section-name selfRef">SFrame</a>
      </h2>
<p id="section-4-1">This document defines an encryption mechanism that provides effective end-to-end
encryption, is simple to implement, has no dependencies on RTP, and minimizes
encryption bandwidth overhead. Because SFrame can encrypt a full frame, rather
than individual packets, bandwidth overhead can reduced by adding encryption
overhead only once per media frame, instead of once per packet.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="application-context">
<section id="section-4.1">
        <h3 id="name-application-context">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-application-context" class="section-name selfRef">Application Context</a>
        </h3>
<p id="section-4.1-1">SFrame is a general encryption framing, which is typically applied in one of two
ways: Either to encrypt whole media frames (per-frame) or individual media
payloads (per-packet).  The scale at which SFrame encryption is applied to media
determines the overall amount of overhead that SFrame adds to the media stream,
as well as the engineering complexity involved in integrating SFrame into a
particular environment.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">For example, <a href="#media-stack" class="auto internal xref">Figure 2</a> shows a typical media stack that takes media in
from some source, encodes it into frames, divides those frames into media
payloads, and then sends those payloads in SRTP packets.  Arrows indicate the
points where SFrame protection would be integrated into this media stack, when
applied per-frame or per-packet.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">Applying SFrame per-frame in this system offers higher efficiency, but may
require a more complex integration in environments where depacketization relies
on the content of media packets. Applying SFrame per-packet avoids this
complexity, at the cost of higher bandwidth consumption.  Some quantitative
discussion of these trade-offs is provided in <a href="#overhead" class="auto internal xref">Appendix B</a>.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">As noted above, however, SFrame is a general media encapsulation, and can be
applied in other scenarios.  The precise efficiency and complexity trade-offs
will depend on the environment in which SFrame is being integrated.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<div id="media-stack">
<figure id="figure-2">
          <div id="section-4.1-5.1">
            <div class="alignLeft art-svg artwork" id="section-4.1-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="512" width="648" viewBox="0 0 648 512" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
                <path d="M 24,112 L 24,144" fill="none" stroke="black"></path>
                <path d="M 24,368 L 24,400" fill="none" stroke="black"></path>
                <path d="M 56,32 L 56,208" fill="none" stroke="black"></path>
                <path d="M 56,320 L 56,496" fill="none" stroke="black"></path>
                <path d="M 80,64 L 80,128" fill="none" stroke="black"></path>
                <path d="M 80,400 L 80,464" fill="none" stroke="black"></path>
                <path d="M 168,64 L 168,128" fill="none" stroke="black"></path>
                <path d="M 168,400 L 168,464" fill="none" stroke="black"></path>
                <path d="M 192,104 L 192,144" fill="none" stroke="black"></path>
                <path d="M 200,384 L 200,424" fill="none" stroke="black"></path>
                <path d="M 224,64 L 224,128" fill="none" stroke="black"></path>
                <path d="M 224,400 L 224,464" fill="none" stroke="black"></path>
                <path d="M 272,136 L 272,392" fill="none" stroke="black"></path>
                <path d="M 336,64 L 336,128" fill="none" stroke="black"></path>
                <path d="M 336,400 L 336,464" fill="none" stroke="black"></path>
                <path d="M 360,104 L 360,144" fill="none" stroke="black"></path>
                <path d="M 368,384 L 368,424" fill="none" stroke="black"></path>
                <path d="M 392,64 L 392,128" fill="none" stroke="black"></path>
                <path d="M 392,400 L 392,464" fill="none" stroke="black"></path>
                <path d="M 440,136 L 440,392" fill="none" stroke="black"></path>
                <path d="M 488,64 L 488,128" fill="none" stroke="black"></path>
                <path d="M 488,400 L 488,464" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,88" fill="none" stroke="black"></path>
                <path d="M 512,104 L 512,208" fill="none" stroke="black"></path>
                <path d="M 512,320 L 512,424" fill="none" stroke="black"></path>
                <path d="M 512,440 L 512,496" fill="none" stroke="black"></path>
                <path d="M 536,240 L 536,288" fill="none" stroke="black"></path>
                <path d="M 584,96 L 584,232" fill="none" stroke="black"></path>
                <path d="M 584,288 L 584,432" fill="none" stroke="black"></path>
                <path d="M 640,240 L 640,288" fill="none" stroke="black"></path>
                <path d="M 56,32 L 512,32" fill="none" stroke="black"></path>
                <path d="M 80,64 L 168,64" fill="none" stroke="black"></path>
                <path d="M 224,64 L 336,64" fill="none" stroke="black"></path>
                <path d="M 392,64 L 488,64" fill="none" stroke="black"></path>
                <path d="M 176,96 L 216,96" fill="none" stroke="black"></path>
                <path d="M 344,96 L 384,96" fill="none" stroke="black"></path>
                <path d="M 496,96 L 584,96" fill="none" stroke="black"></path>
                <path d="M 80,128 L 168,128" fill="none" stroke="black"></path>
                <path d="M 224,128 L 336,128" fill="none" stroke="black"></path>
                <path d="M 392,128 L 488,128" fill="none" stroke="black"></path>
                <path d="M 56,208 L 264,208" fill="none" stroke="black"></path>
                <path d="M 280,208 L 432,208" fill="none" stroke="black"></path>
                <path d="M 448,208 L 512,208" fill="none" stroke="black"></path>
                <path d="M 536,240 L 640,240" fill="none" stroke="black"></path>
                <path d="M 536,288 L 640,288" fill="none" stroke="black"></path>
                <path d="M 56,320 L 264,320" fill="none" stroke="black"></path>
                <path d="M 280,320 L 432,320" fill="none" stroke="black"></path>
                <path d="M 448,320 L 512,320" fill="none" stroke="black"></path>
                <path d="M 80,400 L 168,400" fill="none" stroke="black"></path>
                <path d="M 224,400 L 336,400" fill="none" stroke="black"></path>
                <path d="M 392,400 L 488,400" fill="none" stroke="black"></path>
                <path d="M 176,432 L 216,432" fill="none" stroke="black"></path>
                <path d="M 344,432 L 384,432" fill="none" stroke="black"></path>
                <path d="M 496,432 L 584,432" fill="none" stroke="black"></path>
                <path d="M 80,464 L 168,464" fill="none" stroke="black"></path>
                <path d="M 224,464 L 336,464" fill="none" stroke="black"></path>
                <path d="M 392,464 L 488,464" fill="none" stroke="black"></path>
                <path d="M 56,496 L 512,496" fill="none" stroke="black"></path>
                <path d="M 24,400 L 40,432" fill="none" stroke="black"></path>
                <path d="M 24,368 L 40,400" fill="none" stroke="black"></path>
                <path d="M 24,144 L 40,176" fill="none" stroke="black"></path>
                <path d="M 24,112 L 40,144" fill="none" stroke="black"></path>
                <path d="M 8,144 L 24,112" fill="none" stroke="black"></path>
                <path d="M 8,176 L 24,144" fill="none" stroke="black"></path>
                <path d="M 8,400 L 24,368" fill="none" stroke="black"></path>
                <path d="M 8,432 L 24,400" fill="none" stroke="black"></path>
                <path d="M 24,80 C 15.16936,80 8,87.16936 8,96" fill="none" stroke="black"></path>
                <path d="M 24,80 C 32.83064,80 40,87.16936 40,96" fill="none" stroke="black"></path>
                <path d="M 24,112 C 15.16936,112 8,104.83064 8,96" fill="none" stroke="black"></path>
                <path d="M 24,112 C 32.83064,112 40,104.83064 40,96" fill="none" stroke="black"></path>
                <path d="M 24,336 C 15.16936,336 8,343.16936 8,352" fill="none" stroke="black"></path>
                <path d="M 24,336 C 32.83064,336 40,343.16936 40,352" fill="none" stroke="black"></path>
                <path d="M 24,368 C 15.16936,368 8,360.83064 8,352" fill="none" stroke="black"></path>
                <path d="M 24,368 C 32.83064,368 40,360.83064 40,352" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="592,232 580,226.4 580,237.6" fill="black" transform="rotate(90,584,232)"></polygon>
                <polygon class="arrowhead" points="504,432 492,426.4 492,437.6" fill="black" transform="rotate(180,496,432)"></polygon>
                <polygon class="arrowhead" points="448,392 436,386.4 436,397.6" fill="black" transform="rotate(90,440,392)"></polygon>
                <polygon class="arrowhead" points="448,136 436,130.4 436,141.6" fill="black" transform="rotate(270,440,136)"></polygon>
                <polygon class="arrowhead" points="392,96 380,90.4 380,101.6" fill="black" transform="rotate(0,384,96)"></polygon>
                <polygon class="arrowhead" points="376,424 364,418.4 364,429.6" fill="black" transform="rotate(90,368,424)"></polygon>
                <polygon class="arrowhead" points="368,104 356,98.4 356,109.6" fill="black" transform="rotate(270,360,104)"></polygon>
                <polygon class="arrowhead" points="352,432 340,426.4 340,437.6" fill="black" transform="rotate(180,344,432)"></polygon>
                <polygon class="arrowhead" points="280,392 268,386.4 268,397.6" fill="black" transform="rotate(90,272,392)"></polygon>
                <polygon class="arrowhead" points="280,136 268,130.4 268,141.6" fill="black" transform="rotate(270,272,136)"></polygon>
                <polygon class="arrowhead" points="224,96 212,90.4 212,101.6" fill="black" transform="rotate(0,216,96)"></polygon>
                <polygon class="arrowhead" points="208,424 196,418.4 196,429.6" fill="black" transform="rotate(90,200,424)"></polygon>
                <polygon class="arrowhead" points="200,104 188,98.4 188,109.6" fill="black" transform="rotate(270,192,104)"></polygon>
                <polygon class="arrowhead" points="184,432 172,426.4 172,437.6" fill="black" transform="rotate(180,176,432)"></polygon>
                <g class="text">
                  <text x="436" y="84">SRTP</text>
                  <text x="124" y="100">Encode</text>
                  <text x="280" y="100">Packetize</text>
                  <text x="440" y="100">Encrypt</text>
                  <text x="196" y="164">SFrame</text>
                  <text x="356" y="164">SFrame</text>
                  <text x="200" y="180">Protect</text>
                  <text x="360" y="180">Protect</text>
                  <text x="24" y="196">Alice</text>
                  <text x="200" y="196">(per-frame)</text>
                  <text x="364" y="196">(per-packet)</text>
                  <text x="200" y="260">E2E</text>
                  <text x="232" y="260">Key</text>
                  <text x="368" y="260">HBH</text>
                  <text x="400" y="260">Key</text>
                  <text x="584" y="260">Media</text>
                  <text x="220" y="276">Management</text>
                  <text x="388" y="276">Management</text>
                  <text x="588" y="276">Server</text>
                  <text x="196" y="340">SFrame</text>
                  <text x="364" y="340">SFrame</text>
                  <text x="200" y="356">Unprotect</text>
                  <text x="368" y="356">Unprotect</text>
                  <text x="200" y="372">(per-frame)</text>
                  <text x="372" y="372">(per-packet)</text>
                  <text x="436" y="420">SRTP</text>
                  <text x="124" y="436">Decode</text>
                  <text x="280" y="436">Depacketize</text>
                  <text x="440" y="436">Decrypt</text>
                  <text x="24" y="452">Bob</text>
                </g>
              </svg><a href="#section-4.1-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a></figcaption></figure>
</div>
<p id="section-4.1-6">Like SRTP, SFrame does not define how the keys used for SFrame are exchanged by
the parties in the conference.  Keys for SFrame might be distributed over an
existing E2E-secure channel (see <a href="#sender-keys" class="auto internal xref">Section 5.1</a>), or derived from an E2E-secure
shared secret (see <a href="#mls" class="auto internal xref">Section 5.2</a>).  The key management system MUST ensure that each
key used for encrypting media is used by exactly one media sender, in order to
avoid reuse of IVs.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sframe-ciphertext">
<section id="section-4.2">
        <h3 id="name-sframe-ciphertext">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-sframe-ciphertext" class="section-name selfRef">SFrame Ciphertext</a>
        </h3>
<p id="section-4.2-1">An SFrame ciphertext comprises an SFrame header followed by the output of an
AEAD encryption of the plaintext <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>]</span>, with the header provided as additional
authenticated data (AAD).<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The SFrame header is a variable-length structure described in detail in
<a href="#sframe-header" class="auto internal xref">Section 4.3</a>.  The structure of the encrypted data and authentication tag
are determined by the AEAD algorithm in use.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<div id="section-4.2-3">
          <div class="alignLeft art-svg artwork" id="section-4.2-3.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="320" width="496" viewBox="0 0 496 320" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 8,64 L 8,304" fill="none" stroke="black"></path>
              <path d="M 24,32 L 24,256" fill="none" stroke="black"></path>
              <path d="M 40,32 L 40,64" fill="none" stroke="black"></path>
              <path d="M 72,32 L 72,64" fill="none" stroke="black"></path>
              <path d="M 88,32 L 88,64" fill="none" stroke="black"></path>
              <path d="M 128,32 L 128,64" fill="none" stroke="black"></path>
              <path d="M 472,32 L 472,256" fill="none" stroke="black"></path>
              <path d="M 488,32 L 488,304" fill="none" stroke="black"></path>
              <path d="M 24,32 L 472,32" fill="none" stroke="black"></path>
              <path d="M 24,64 L 472,64" fill="none" stroke="black"></path>
              <path d="M 24,224 L 472,224" fill="none" stroke="black"></path>
              <path d="M 24,256 L 472,256" fill="none" stroke="black"></path>
              <path d="M 8,304 L 40,304" fill="none" stroke="black"></path>
              <path d="M 464,304 L 488,304" fill="none" stroke="black"></path>
              <g class="text">
                <text x="480" y="36">^</text>
                <text x="32" y="52">S</text>
                <text x="56" y="52">LEN</text>
                <text x="80" y="52">X</text>
                <text x="104" y="52">KID</text>
                <text x="224" y="52">Frame</text>
                <text x="280" y="52">Counter</text>
                <text x="16" y="68">^</text>
                <text x="216" y="148">Encrypted</text>
                <text x="276" y="148">Data</text>
                <text x="16" y="228">&gt;</text>
                <text x="480" y="228">&lt;</text>
                <text x="220" y="244">Authentication</text>
                <text x="296" y="244">Tag</text>
                <text x="88" y="308">Encrypted</text>
                <text x="160" y="308">Portion</text>
                <text x="336" y="308">Authenticated</text>
                <text x="424" y="308">Portion</text>
              </g>
            </svg><a href="#section-4.2-3.1" class="pilcrow">¶</a>
</div>
</div>
<p id="section-4.2-4">When SFrame is applied per-packet, the payload of each packet will be an SFrame
ciphertext.  When SFrame is applied per-frame, the SFrame ciphertext
representing an encrypted frame will span several packets, with the header
appearing in the first packet and the authentication tag in the last packet.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sframe-header">
<section id="section-4.3">
        <h3 id="name-sframe-header">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-sframe-header" class="section-name selfRef">SFrame Header</a>
        </h3>
<p id="section-4.3-1">The SFrame header specifies two values from which encryption parameters are
derived:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.1">A Key ID (KID) that determines which encryption key should be used<a href="#section-4.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-2.2">A counter (CTR) that is used to construct the IV for the encryption<a href="#section-4.3-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-3">Applications MUST ensure that each (KID, CTR) combination is used for exactly
one encryption operation.  Typically this is done by assigning each sender a KID
or set of KIDs, then having each sender use the CTR field as a monotonic
counter, incrementing for each plaintext that is encrypted.  Note that in
addition to its simplicity, this scheme minimizes overhead by keeping CTR values
as small as possible.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">Both the counter and the key id are encoded as integers in network (big-endian)
byte order, in a variable length format to decrease the overhead.  The length of
each field is up to 8 bytes and is represented in 3 bits in the SFrame header:
000 represents a length of 1, 001 a length of 2, etc.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">The first byte in the SFrame header has a fixed format and contains the header
metadata:<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<span id="name-sframe-header-metadata"></span><figure id="figure-3">
          <div id="section-4.3-6.1">
            <div class="alignLeft art-svg artwork" id="section-4.3-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="96" width="144" viewBox="0 0 144 96" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
                <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
                <path d="M 24,48 L 24,80" fill="none" stroke="black"></path>
                <path d="M 72,48 L 72,80" fill="none" stroke="black"></path>
                <path d="M 88,48 L 88,80" fill="none" stroke="black"></path>
                <path d="M 136,48 L 136,80" fill="none" stroke="black"></path>
                <path d="M 8,48 L 136,48" fill="none" stroke="black"></path>
                <path d="M 8,80 L 136,80" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="16" y="36">0</text>
                  <text x="32" y="36">1</text>
                  <text x="48" y="36">2</text>
                  <text x="64" y="36">3</text>
                  <text x="80" y="36">4</text>
                  <text x="96" y="36">5</text>
                  <text x="112" y="36">6</text>
                  <text x="128" y="36">7</text>
                  <text x="16" y="68">R</text>
                  <text x="48" y="68">LEN</text>
                  <text x="80" y="68">X</text>
                  <text x="112" y="68">K</text>
                </g>
              </svg><a href="#section-4.3-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-sframe-header-metadata" class="selfRef">SFrame header metadata</a>
          </figcaption></figure>
<span class="break"></span><dl class="dlParallel" id="section-4.3-7">
          <dt id="section-4.3-7.1">Reserved (R, 1 bit):</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-7.2">
            <p id="section-4.3-7.2.1">This field MUST be set to zero on sending, and MUST be ignored by receivers.<a href="#section-4.3-7.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-7.3">Counter Length (LEN, 3 bits):</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-7.4">
            <p id="section-4.3-7.4.1">This field indicates the length of the CTR field in bytes, minus one (the
range of possible values is thus 1-8).<a href="#section-4.3-7.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-7.5">Extended Key Id Flag (X, 1 bit):</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-7.6">
            <p id="section-4.3-7.6.1">Indicates if the key field contains the key id or the key length.<a href="#section-4.3-7.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-7.7">Key or Key Length (K, 3 bits):</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-7.8">
            <p id="section-4.3-7.8.1">This field contains the key id (KID) if the X flag is set to 0, or the key
length (KLEN) if set to 1.<a href="#section-4.3-7.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-8">If X flag is 0, then the KID is in the range of 0-7 and the counter (CTR) is
found in the next LEN bytes:<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<span id="name-sframe-header-with-short-ki"></span><figure id="figure-4">
          <div id="section-4.3-9.1">
            <div class="alignLeft art-svg artwork" id="section-4.3-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="96" width="416" viewBox="0 0 416 96" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
                <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
                <path d="M 24,48 L 24,80" fill="none" stroke="black"></path>
                <path d="M 72,48 L 72,80" fill="none" stroke="black"></path>
                <path d="M 88,48 L 88,80" fill="none" stroke="black"></path>
                <path d="M 136,48 L 136,80" fill="none" stroke="black"></path>
                <path d="M 408,48 L 408,80" fill="none" stroke="black"></path>
                <path d="M 8,48 L 408,48" fill="none" stroke="black"></path>
                <path d="M 8,80 L 408,80" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="16" y="36">0</text>
                  <text x="32" y="36">1</text>
                  <text x="48" y="36">2</text>
                  <text x="64" y="36">3</text>
                  <text x="80" y="36">4</text>
                  <text x="96" y="36">5</text>
                  <text x="112" y="36">6</text>
                  <text x="128" y="36">7</text>
                  <text x="16" y="68">R</text>
                  <text x="40" y="68">LEN</text>
                  <text x="80" y="68">0</text>
                  <text x="112" y="68">KID</text>
                  <text x="196" y="68">CTR...</text>
                  <text x="276" y="68">(length=LEN)</text>
                </g>
              </svg><a href="#section-4.3-9.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-sframe-header-with-short-ki" class="selfRef">SFrame header with short KID</a>
          </figcaption></figure>
<p id="section-4.3-10">If X flag is 1 then KLEN is the length of the key (KID) in bytes, minus one
(the range of possible lengths is thus 1-8). The KID is encoded in
the KLEN bytes following the metadata byte, and the counter (CTR) is encoded
in the next LEN bytes:<a href="#section-4.3-10" class="pilcrow">¶</a></p>
<div id="section-4.3-11">
          <div class="alignLeft art-svg artwork" id="section-4.3-11.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="96" width="592" viewBox="0 0 592 96" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
              <path d="M 24,48 L 24,80" fill="none" stroke="black"></path>
              <path d="M 72,48 L 72,80" fill="none" stroke="black"></path>
              <path d="M 88,48 L 88,80" fill="none" stroke="black"></path>
              <path d="M 136,48 L 136,80" fill="none" stroke="black"></path>
              <path d="M 360,48 L 360,80" fill="none" stroke="black"></path>
              <path d="M 584,48 L 584,80" fill="none" stroke="black"></path>
              <path d="M 8,48 L 584,48" fill="none" stroke="black"></path>
              <path d="M 8,80 L 584,80" fill="none" stroke="black"></path>
              <g class="text">
                <text x="16" y="36">0</text>
                <text x="32" y="36">1</text>
                <text x="48" y="36">2</text>
                <text x="64" y="36">3</text>
                <text x="80" y="36">4</text>
                <text x="96" y="36">5</text>
                <text x="112" y="36">6</text>
                <text x="128" y="36">7</text>
                <text x="16" y="68">R</text>
                <text x="40" y="68">LEN</text>
                <text x="80" y="68">1</text>
                <text x="108" y="68">KLEN</text>
                <text x="188" y="68">KID...</text>
                <text x="272" y="68">(length=KLEN)</text>
                <text x="420" y="68">CTR...</text>
                <text x="500" y="68">(length=LEN)</text>
              </g>
            </svg><a href="#section-4.3-11.1" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
<div id="encryption-schema">
<section id="section-4.4">
        <h3 id="name-encryption-schema">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-encryption-schema" class="section-name selfRef">Encryption Schema</a>
        </h3>
<p id="section-4.4-1">SFrame encryption uses an AEAD encryption algorithm and hash function defined by
the ciphersuite in use (see <a href="#ciphersuites" class="auto internal xref">Section 4.5</a>).  We will refer to the following
aspects of the AEAD algorithm below:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">
            <code>AEAD.Encrypt</code> and <code>AEAD.Decrypt</code> - The encryption and decryption functions
for the AEAD.  We follow the convention of RFC 5116 <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>]</span> and consider
the authentication tag part of the ciphertext produced by <code>AEAD.Encrypt</code> (as
opposed to a separate field as in SRTP <span>[<a href="#RFC3711" class="cite xref">RFC3711</a>]</span>).<a href="#section-4.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-2.2">
            <code>AEAD.Nk</code> - The size of a key for the encryption algorithm, in bytes<a href="#section-4.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-2.3">
            <code>AEAD.Nn</code> - The size of a nonce for the encryption algorithm, in bytes<a href="#section-4.4-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-2.4">
            <code>AEAD.Nt</code> - The overhead of the encryption algorithm, in bytes (typically the
size of a "tag" that is added to the plaintext)<a href="#section-4.4-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<div id="key-selection">
<section id="section-4.4.1">
          <h4 id="name-key-selection">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-key-selection" class="section-name selfRef">Key Selection</a>
          </h4>
<p id="section-4.4.1-1">Each SFrame encryption or decryption operation is premised on a single secret
<code>base_key</code>, which is labeled with an integer KID value signaled in the SFrame
header.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-2">The sender and receivers need to agree on which key should be used for a given
KID.  The process for provisioning keys and their KID values is beyond the scope
of this specification, but its security properties will bound the assurances
that SFrame provides.  For example, if SFrame is used to provide E2E security
against intermediary media nodes, then SFrame keys need to be negotiated in a
way that does not make them accessible to these intermediaries.<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.4.1-3">For each known KID value, the client stores the corresponding symmetric key
<code>base_key</code>.  For keys that can be used for encryption, the client also stores
the next counter value CTR to be used when encrypting (initially 0).<a href="#section-4.4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.4.1-4">When encrypting a plaintext, the application specifies which KID is to be used,
and the counter is incremented after successful encryption.  When decrypting,
the <code>base_key</code> for decryption is selected from the available keys using the KID
value in the SFrame Header.<a href="#section-4.4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.4.1-5">A given key MUST NOT be used for encryption by multiple senders.  Such reuse
would result in multiple encrypted frames being generated with the same (key,
nonce) pair, which harms the protections provided by many AEAD algorithms.
Implementations SHOULD mark each key as usable for encryption or decryption,
never both.<a href="#section-4.4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.4.1-6">Note that the set of available keys might change over the lifetime of a
real-time session.  In such cases, the client will need to manage key usage to
avoid media loss due to a key being used to encrypt before all receivers are
able to use it to decrypt.  For example, an application may make decryption-only
keys available immediately, but delay the use of keys for encryption until (a)
all receivers have acknowledged receipt of the new key or (b) a timeout expires.<a href="#section-4.4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-derivation">
<section id="section-4.4.2">
          <h4 id="name-key-derivation">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-key-derivation" class="section-name selfRef">Key Derivation</a>
          </h4>
<p id="section-4.4.2-1">SFrame encrytion and decryption use a key and salt derived from the <code>base_key</code>
associated to a KID.  Given a <code>base_key</code> value, the key and salt are derived
using HKDF <span>[<a href="#RFC5869" class="cite xref">RFC5869</a>]</span> as follows:<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.2-2">
<pre>
sframe_secret = HKDF-Extract(base_key, 'SFrame10')
sframe_key = HKDF-Expand(sframe_secret, 'key', AEAD.Nk)
sframe_salt = HKDF-Expand(sframe_secret, 'salt', AEAD.Nn)
</pre><a href="#section-4.4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.4.2-3">The hash function used for HKDF is determined by the ciphersuite in use.<a href="#section-4.4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encryption">
<section id="section-4.4.3">
          <h4 id="name-encryption">
<a href="#section-4.4.3" class="section-number selfRef">4.4.3. </a><a href="#name-encryption" class="section-name selfRef">Encryption</a>
          </h4>
<p id="section-4.4.3-1">SFrame encryption uses the AEAD encryption algorithm for the ciphersuite in use.
The key for the encryption is the <code>sframe_key</code> and the nonce is formed by XORing
the <code>sframe_salt</code> with the current counter, encoded as a big-endian integer of
length <code>AEAD.Nn</code>.<a href="#section-4.4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.4.3-2">The encryptor forms an SFrame header using the CTR, and KID values provided.
The encoded header is provided as AAD to the AEAD encryption operation, together
with application-provided metadata about the encrypted media.<a href="#section-4.4.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.3-3">
<pre>
def encrypt(S, CTR, KID, metadata, plaintext):
  sframe_key, sframe_salt = key_store[KID]

  ctr = encode_big_endian(CTR, AEAD.Nn)
  nonce = xor(sframe_salt, CTR)

  header = encode_sframe_header(CTR, KID)
  aad = header + metadata

  ciphertext = AEAD.Encrypt(sframe_key, nonce, aad, plaintext)
  return header + ciphertext
</pre><a href="#section-4.4.3-3" class="pilcrow">¶</a>
</div>
<p id="section-4.4.3-4">The metadata input to encryption allows for frame metadata to be authenticated
when SFrame is applied per-frame.  After encoding the frame and before
packetizing it, the necessary media metadata will be moved out of the encoded
frame buffer, to be sent in some channel visibile to the SFU (e.g., an RTP
header extension).<a href="#section-4.4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.4.3-5">The encrypted payload is then passed to a generic RTP packetized to construct
the RTP packets and encrypt it using SRTP keys for the HBH encryption to the
media server.<a href="#section-4.4.3-5" class="pilcrow">¶</a></p>
<span id="name-encryption-flow-with-per-fr"></span><figure id="figure-5">
            <div id="section-4.4.3-6.1">
              <div class="alignLeft art-svg artwork" id="section-4.4.3-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="752" width="504" viewBox="0 0 504 752" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
                  <path d="M 8,176 L 8,336" fill="none" stroke="black"></path>
                  <path d="M 8,640 L 8,736" fill="none" stroke="black"></path>
                  <path d="M 32,32 L 32,64" fill="none" stroke="black"></path>
                  <path d="M 32,344 L 32,632" fill="none" stroke="black"></path>
                  <path d="M 56,176 L 56,336" fill="none" stroke="black"></path>
                  <path d="M 72,592 L 72,632" fill="none" stroke="black"></path>
                  <path d="M 80,224 L 80,256" fill="none" stroke="black"></path>
                  <path d="M 96,64 L 96,160" fill="none" stroke="black"></path>
                  <path d="M 136,640 L 136,736" fill="none" stroke="black"></path>
                  <path d="M 168,32 L 168,64" fill="none" stroke="black"></path>
                  <path d="M 192,32 L 192,128" fill="none" stroke="black"></path>
                  <path d="M 192,400 L 192,512" fill="none" stroke="black"></path>
                  <path d="M 192,640 L 192,736" fill="none" stroke="black"></path>
                  <path d="M 232,256 L 232,288" fill="none" stroke="black"></path>
                  <path d="M 256,128 L 256,392" fill="none" stroke="black"></path>
                  <path d="M 256,512 L 256,528" fill="none" stroke="black"></path>
                  <path d="M 256,560 L 256,632" fill="none" stroke="black"></path>
                  <path d="M 320,32 L 320,128" fill="none" stroke="black"></path>
                  <path d="M 320,400 L 320,512" fill="none" stroke="black"></path>
                  <path d="M 320,640 L 320,736" fill="none" stroke="black"></path>
                  <path d="M 368,640 L 368,736" fill="none" stroke="black"></path>
                  <path d="M 432,592 L 432,632" fill="none" stroke="black"></path>
                  <path d="M 496,640 L 496,736" fill="none" stroke="black"></path>
                  <path d="M 32,32 L 168,32" fill="none" stroke="black"></path>
                  <path d="M 192,32 L 320,32" fill="none" stroke="black"></path>
                  <path d="M 32,64 L 168,64" fill="none" stroke="black"></path>
                  <path d="M 192,128 L 320,128" fill="none" stroke="black"></path>
                  <path d="M 64,160 L 248,160" fill="none" stroke="black"></path>
                  <path d="M 8,176 L 56,176" fill="none" stroke="black"></path>
                  <path d="M 8,208 L 56,208" fill="none" stroke="black"></path>
                  <path d="M 56,224 L 104,224" fill="none" stroke="black"></path>
                  <path d="M 208,224 L 248,224" fill="none" stroke="black"></path>
                  <path d="M 80,256 L 104,256" fill="none" stroke="black"></path>
                  <path d="M 216,256 L 232,256" fill="none" stroke="black"></path>
                  <path d="M 8,272 L 56,272" fill="none" stroke="black"></path>
                  <path d="M 56,288 L 248,288" fill="none" stroke="black"></path>
                  <path d="M 8,336 L 56,336" fill="none" stroke="black"></path>
                  <path d="M 192,400 L 320,400" fill="none" stroke="black"></path>
                  <path d="M 192,512 L 320,512" fill="none" stroke="black"></path>
                  <path d="M 72,592 L 328,592" fill="none" stroke="black"></path>
                  <path d="M 360,592 L 432,592" fill="none" stroke="black"></path>
                  <path d="M 8,640 L 136,640" fill="none" stroke="black"></path>
                  <path d="M 192,640 L 320,640" fill="none" stroke="black"></path>
                  <path d="M 368,640 L 496,640" fill="none" stroke="black"></path>
                  <path d="M 8,672 L 136,672" fill="none" stroke="black"></path>
                  <path d="M 8,736 L 136,736" fill="none" stroke="black"></path>
                  <path d="M 192,736 L 320,736" fill="none" stroke="black"></path>
                  <path d="M 368,736 L 496,736" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="440,632 428,626.4 428,637.6" fill="black" transform="rotate(90,432,632)"></polygon>
                  <polygon class="arrowhead" points="264,632 252,626.4 252,637.6" fill="black" transform="rotate(90,256,632)"></polygon>
                  <polygon class="arrowhead" points="264,392 252,386.4 252,397.6" fill="black" transform="rotate(90,256,392)"></polygon>
                  <polygon class="arrowhead" points="256,288 244,282.4 244,293.6" fill="black" transform="rotate(0,248,288)"></polygon>
                  <polygon class="arrowhead" points="256,224 244,218.4 244,229.6" fill="black" transform="rotate(0,248,224)"></polygon>
                  <polygon class="arrowhead" points="256,160 244,154.4 244,165.6" fill="black" transform="rotate(0,248,160)"></polygon>
                  <polygon class="arrowhead" points="112,256 100,250.4 100,261.6" fill="black" transform="rotate(0,104,256)"></polygon>
                  <polygon class="arrowhead" points="112,224 100,218.4 100,229.6" fill="black" transform="rotate(0,104,224)"></polygon>
                  <polygon class="arrowhead" points="80,632 68,626.4 68,637.6" fill="black" transform="rotate(90,72,632)"></polygon>
                  <polygon class="arrowhead" points="40,632 28,626.4 28,637.6" fill="black" transform="rotate(90,32,632)"></polygon>
                  <g class="text">
                    <text x="64" y="52">frame</text>
                    <text x="124" y="52">metadata</text>
                    <text x="256" y="84">frame</text>
                    <text x="28" y="164">header</text>
                    <text x="280" y="164">AAD</text>
                    <text x="32" y="196">S</text>
                    <text x="32" y="228">KID</text>
                    <text x="156" y="228">sframe_key</text>
                    <text x="280" y="228">Key</text>
                    <text x="160" y="260">sframe_salt</text>
                    <text x="32" y="292">CTR</text>
                    <text x="288" y="292">Nonce</text>
                    <text x="236" y="356">AEAD</text>
                    <text x="288" y="356">Encrypt</text>
                    <text x="256" y="452">encrypted</text>
                    <text x="256" y="468">frame</text>
                    <text x="208" y="548">generic</text>
                    <text x="256" y="548">RTP</text>
                    <text x="312" y="548">packetize</text>
                    <text x="344" y="596">...</text>
                    <text x="44" y="660">SFrame</text>
                    <text x="100" y="660">header</text>
                    <text x="240" y="692">payload</text>
                    <text x="288" y="692">2/N</text>
                    <text x="344" y="692">...</text>
                    <text x="416" y="692">payload</text>
                    <text x="464" y="692">N/N</text>
                    <text x="56" y="708">payload</text>
                    <text x="104" y="708">1/N</text>
                  </g>
                </svg><a href="#section-4.4.3-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-encryption-flow-with-per-fr" class="selfRef">Encryption flow with per-frame encryption</a>
            </figcaption></figure>
</section>
</div>
<div id="decryption">
<section id="section-4.4.4">
          <h4 id="name-decryption">
<a href="#section-4.4.4" class="section-number selfRef">4.4.4. </a><a href="#name-decryption" class="section-name selfRef">Decryption</a>
          </h4>
<p id="section-4.4.4-1">Before decrypting, a client needs to assemble a full SFrame ciphertext.  When
SFrame is applied per-packet, this is done by extracting the payload of a
decrypted SRTP packet.  When SFrame is applied per-frame, the receiving client
buffers all packets that belongs to the same frame using the frame beginning and
ending marks in the generic RTP frame header extension. Once all packets are
available and in order, the receiver forms an SFrame ciphertext by concatenating
their payloads, then passes the ciphertext to SFrame for decryption.<a href="#section-4.4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4.4-2">The KID field in the SFrame header is used to find the right key and salt for
the encrypted frame, and the CTR field is used to construct the nonce.<a href="#section-4.4.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.4-3">
<pre>
def decrypt(metadata, sframe):
  CTR, KID, ciphertext = parse_ciphertext(sframe)

  sframe_key, sframe_salt = key_store[KID]

  ctr = encode_big_endian(CTR, AEAD.Nn)
  nonce = xor(sframe_salt, ctr)
  aad = header + metadata

  return AEAD.Decrypt(sframe_key, nonce, aad, ciphertext)
</pre><a href="#section-4.4.4-3" class="pilcrow">¶</a>
</div>
<p id="section-4.4.4-4">If a ciphertext fails to decrypt because there is no key available for the KID
in the SFrame header, the client MAY buffer the ciphertext and retry decryption
once a key with that KID is received.<a href="#section-4.4.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="duplicate-frames">
<section id="section-4.4.5">
          <h4 id="name-duplicate-frames">
<a href="#section-4.4.5" class="section-number selfRef">4.4.5. </a><a href="#name-duplicate-frames" class="section-name selfRef">Duplicate Frames</a>
          </h4>
<p id="section-4.4.5-1">Unlike messaging application, in video calls, receiving a duplicate frame
doesn't necessary mean the client is under a replay attack, there are other
reasons that might cause this, for example the sender might just be sending them
in case of packet loss. SFrame decryptors use the highest received frame counter
to protect against this. It allows only older frame pithing a short interval to
support out of order delivery.<a href="#section-4.4.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ciphersuites">
<section id="section-4.5">
        <h3 id="name-ciphersuites">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-ciphersuites" class="section-name selfRef">Ciphersuites</a>
        </h3>
<p id="section-4.5-1">Each SFrame session uses a single ciphersuite that specifies the following
primitives:<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-2.1">A hash function used for key derivation<a href="#section-4.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-2.2">An AEAD encryption algorithm <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>]</span> used for frame encryption, optionally
with a truncated authentication tag<a href="#section-4.5-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.5-3">This document defines the following ciphersuites:<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Nh</th>
              <th class="text-left" rowspan="1" colspan="1">Nk</th>
              <th class="text-left" rowspan="1" colspan="1">Nn</th>
              <th class="text-left" rowspan="1" colspan="1">Nt</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0001</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>AES_CTR_128_HMAC_SHA256_80</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">32</td>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">12</td>
              <td class="text-left" rowspan="1" colspan="1">10</td>
              <td class="text-left" rowspan="1" colspan="1">RFC XXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0002</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>AES_CTR_128_HMAC_SHA256_64</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">32</td>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">12</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">RFC XXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0003</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>AES_CTR_128_HMAC_SHA256_32</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">32</td>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">12</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">RFC XXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0004</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>AES_GCM_128_SHA256_128</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">32</td>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">12</td>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">RFC XXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0005</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>AES_GCM_256_SHA512_128</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">64</td>
              <td class="text-left" rowspan="1" colspan="1">32</td>
              <td class="text-left" rowspan="1" colspan="1">12</td>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">RFC XXXX</td>
            </tr>
          </tbody>
        </table>
<p id="section-4.5-5">In the suite names, the length of the authentication tag is indicated by
the last value: "_128" indicates a hundred-twenty-eight-bit tag, "_80" indicates
a eighty-bit tag, "_64" indicates a sixty-four-bit tag and "_32" indicates a
thirty-two-bit tag.<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<p id="section-4.5-6">In a session that uses multiple media streams, different ciphersuites might be
configured for different media streams.  For example, in order to conserve
bandwidth, a session might use a ciphersuite with eighty-bit tags for video frames
and another ciphersuite with thirty-two-bit tags for audio frames.<a href="#section-4.5-6" class="pilcrow">¶</a></p>
<div id="aes-ctr-with-sha2">
<section id="section-4.5.1">
          <h4 id="name-aes-ctr-with-sha2">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-aes-ctr-with-sha2" class="section-name selfRef">AES-CTR with SHA2</a>
          </h4>
<p id="section-4.5.1-1">In order to allow very short tag sizes, we define a synthetic AEAD function
using the authenticated counter mode of AES together with HMAC for
authentication.  We use an encrypt-then-MAC approach as in SRTP <span>[<a href="#RFC3711" class="cite xref">RFC3711</a>]</span>.<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.1-2">Before encryption or decryption, encryption and authentication subkeys are
derived from the single AEAD key using HKDF.  The subkeys are derived as
follows, where <code>Nk</code> represents the key size for the AES block cipher in use and
<code>Nh</code> represents the output size of the hash function:<a href="#section-4.5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5.1-3">
<pre>
def derive_subkeys(sframe_key):
  aead_secret = HKDF-Extract(sframe_key, 'SFrame10 AES CTR AEAD')
  enc_key = HKDF-Expand(aead_secret, 'enc', Nk)
  auth_key = HKDF-Expand(aead_secret, 'auth', Nh)
  return enc_key, auth_key
</pre><a href="#section-4.5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.5.1-4">The AEAD encryption and decryption functions are then composed of individual
calls to the CTR encrypt function and HMAC.  The resulting MAC value is truncated
to a number of bytes <code>tag_len</code> fixed by the ciphersuite.<a href="#section-4.5.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5.1-5">
<pre>
def compute_tag(auth_key, nonce, aad, ct):
  aad_len = encode_big_endian(len(aad), 8)
  ct_len = encode_big_endian(len(ct), 8)
  auth_data = aad_len + ct_len + nonce + aad + ct
  tag = HMAC(auth_key, auth_data)
  return truncate(tag, tag_len)

def AEAD.Encrypt(key, nonce, aad, pt):
  enc_key, auth_key = derive_subkeys(key)
  ct = AES-CTR.Encrypt(enc_key, nonce, pt)
  tag = compute_tag(auth_key, nonce, aad, ct)
  return ct + tag

def AEAD.Decrypt(key, nonce, aad, ct):
  inner_ct, tag = split_ct(ct, tag_len)

  enc_key, auth_key = derive_subkeys(key)
  candidate_tag = compute_tag(auth_key, nonce, aad, inner_ct)
  if !constant_time_equal(tag, candidate_tag):
    raise Exception("Authentication Failure")

  return AES-CTR.Decrypt(enc_key, nonce, inner_ct)
</pre><a href="#section-4.5.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="key-management">
<section id="section-5">
      <h2 id="name-key-management">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-key-management" class="section-name selfRef">Key Management</a>
      </h2>
<p id="section-5-1">SFrame must be integrated with an E2E key management framework to exchange and
rotate the keys used for SFrame encryption. The key management
framework provides the following functions:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">Provisioning KID/<code>base_key</code> mappings to participating clients<a href="#section-5-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-2.2">Updating the above data as clients join or leave<a href="#section-5-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-3">It is up to the application to define a rotation schedule for keys.  For example,
one application might have an ephemeral group for every call and keep rotating key
when end points joins or leave the call, while another application could have a
persistent group that can be used for multiple calls and simply derives
ephemeral symmetric keys for a specific call.<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="sender-keys">
<section id="section-5.1">
        <h3 id="name-sender-keys">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-sender-keys" class="section-name selfRef">Sender Keys</a>
        </h3>
<p id="section-5.1-1">If the participants in a call have a pre-existing E2E-secure channel, they can
use it to distribute SFrame keys.  Each client participating in a call generates
a fresh encryption key. The client then uses
the E2E-secure channel to send their encryption key to
the other participants.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">In this scheme, it is assumed that receivers have a signal outside of SFrame for
which client has sent a given frame, for example the RTP SSRC.  SFrame KID
values are then used to distinguish generations of the sender's key.  At the
beginning of a call, each sender encrypts with KID=0.  Thereafter, the sender
can ratchet their key forward for forward secrecy:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-3">
<pre>
sender_key[i+1] = HKDF-Expand(
                    HKDF-Extract(sender_key[i], 'SFrame10 ratchet'),
                      '', AEAD.Nk)
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1-4">The sender signals such an update by incrementing their KID value.  A receiver
who receives from a sender with a new KID computes the new key as above.  The
old key may be kept for some time to allow for out-of-order delivery, but should
be deleted promptly.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">If a new participant joins mid-call, they will need to receive from each sender
(a) the current sender key for that sender and (b) the current KID value for the
sender. Evicting a participant requires each sender to send a fresh sender key
to all receivers.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mls">
<section id="section-5.2">
        <h3 id="name-mls">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-mls" class="section-name selfRef">MLS</a>
        </h3>
<p id="section-5.2-1">The Messaging Layer Security (MLS) protocol provides group authenticated key
exchange <span>[<a href="#I-D.ietf-mls-architecture" class="cite xref">I-D.ietf-mls-architecture</a>]</span> <span>[<a href="#I-D.ietf-mls-protocol" class="cite xref">I-D.ietf-mls-protocol</a>]</span>.  In
principle, it could be used to instantiate the sender key scheme above, but it
can also be used more efficiently directly.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">MLS creates a linear sequence of keys, each of which is shared among the members
of a group at a given point in time.  When a member joins or leaves the group, a
new key is produced that is known only to the augmented or reduced group.  Each
step in the lifetime of the group is know as an "epoch", and each member of the
group is assigned an "index" that is constant for the time they are in the
group.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">In SFrame, we derive per-sender <code>base_key</code> values from the group secret for an
epoch, and use the KID field to signal the epoch and sender index.  First, we
use the MLS exporter to compute a shared SFrame secret for the epoch.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-4">
<pre>
sframe_epoch_secret = MLS-Exporter("SFrame 10 MLS", "", AEAD.Nk)

sender_base_key[index] = HKDF-Expand(sframe_epoch_secret,
                           encode_big_endian(index, 4), AEAD.Nk)
</pre><a href="#section-5.2-4" class="pilcrow">¶</a>
</div>
<p id="section-5.2-5">For compactness, do not send the whole epoch number.  Instead, we send only its
low-order E bits.  Note that E effectively defines a re-ordering window, since
no more than 2^E epoch can be active at a given time.  Receivers MUST be
prepared for the epoch counter to roll over, removing an old epoch when a new
epoch with the same E lower bits is introduced.  (Sender indices cannot be
similarly compressed.)<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-6">
<pre>
KID = (sender_index &lt;&lt; E) + (epoch % (1 &lt;&lt; E))
</pre><a href="#section-5.2-6" class="pilcrow">¶</a>
</div>
<p id="section-5.2-7">Once an SFrame stack has been provisioned with the <code>sframe_epoch_secret</code> for an
epoch, it can compute the required KIDs and <code>sender_base_key</code> values on demand,
as it needs to encrypt/decrypt for a given member.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<div id="section-5.2-8">
          <div class="alignLeft art-svg artwork" id="section-5.2-8.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="384" width="328" viewBox="0 0 328 384" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 80,48 L 80,352" fill="none" stroke="black"></path>
              <path d="M 104,64 L 104,96" fill="none" stroke="black"></path>
              <path d="M 104,192 L 104,224" fill="none" stroke="black"></path>
              <path d="M 104,272 L 104,336" fill="none" stroke="black"></path>
              <path d="M 80,64 L 120,64" fill="none" stroke="black"></path>
              <path d="M 208,64 L 224,64" fill="none" stroke="black"></path>
              <path d="M 104,96 L 120,96" fill="none" stroke="black"></path>
              <path d="M 208,96 L 224,96" fill="none" stroke="black"></path>
              <path d="M 80,144 L 120,144" fill="none" stroke="black"></path>
              <path d="M 200,144 L 224,144" fill="none" stroke="black"></path>
              <path d="M 80,192 L 120,192" fill="none" stroke="black"></path>
              <path d="M 200,192 L 224,192" fill="none" stroke="black"></path>
              <path d="M 104,224 L 120,224" fill="none" stroke="black"></path>
              <path d="M 200,224 L 224,224" fill="none" stroke="black"></path>
              <path d="M 80,272 L 120,272" fill="none" stroke="black"></path>
              <path d="M 200,272 L 224,272" fill="none" stroke="black"></path>
              <path d="M 104,304 L 120,304" fill="none" stroke="black"></path>
              <path d="M 200,304 L 224,304" fill="none" stroke="black"></path>
              <path d="M 104,336 L 120,336" fill="none" stroke="black"></path>
              <path d="M 208,336 L 224,336" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="232,336 220,330.4 220,341.6" fill="black" transform="rotate(0,224,336)"></polygon>
              <polygon class="arrowhead" points="232,304 220,298.4 220,309.6" fill="black" transform="rotate(0,224,304)"></polygon>
              <polygon class="arrowhead" points="232,272 220,266.4 220,277.6" fill="black" transform="rotate(0,224,272)"></polygon>
              <polygon class="arrowhead" points="232,224 220,218.4 220,229.6" fill="black" transform="rotate(0,224,224)"></polygon>
              <polygon class="arrowhead" points="232,192 220,186.4 220,197.6" fill="black" transform="rotate(0,224,192)"></polygon>
              <polygon class="arrowhead" points="232,144 220,138.4 220,149.6" fill="black" transform="rotate(0,224,144)"></polygon>
              <polygon class="arrowhead" points="232,96 220,90.4 220,101.6" fill="black" transform="rotate(0,224,96)"></polygon>
              <polygon class="arrowhead" points="232,64 220,58.4 220,69.6" fill="black" transform="rotate(0,224,64)"></polygon>
              <g class="text">
                <text x="32" y="36">...</text>
                <text x="24" y="68">Epoch</text>
                <text x="60" y="68">17</text>
                <text x="164" y="68">index=33</text>
                <text x="248" y="68">KID</text>
                <text x="272" y="68">=</text>
                <text x="304" y="68">0x211</text>
                <text x="164" y="100">index=51</text>
                <text x="248" y="100">KID</text>
                <text x="272" y="100">=</text>
                <text x="304" y="100">0x331</text>
                <text x="24" y="148">Epoch</text>
                <text x="60" y="148">16</text>
                <text x="160" y="148">index=2</text>
                <text x="248" y="148">KID</text>
                <text x="272" y="148">=</text>
                <text x="300" y="148">0x20</text>
                <text x="24" y="196">Epoch</text>
                <text x="60" y="196">15</text>
                <text x="160" y="196">index=3</text>
                <text x="248" y="196">KID</text>
                <text x="272" y="196">=</text>
                <text x="300" y="196">0x3f</text>
                <text x="160" y="228">index=5</text>
                <text x="248" y="228">KID</text>
                <text x="272" y="228">=</text>
                <text x="300" y="228">0x5f</text>
                <text x="24" y="276">Epoch</text>
                <text x="60" y="276">14</text>
                <text x="160" y="276">index=3</text>
                <text x="248" y="276">KID</text>
                <text x="272" y="276">=</text>
                <text x="300" y="276">0x3e</text>
                <text x="160" y="308">index=7</text>
                <text x="248" y="308">KID</text>
                <text x="272" y="308">=</text>
                <text x="300" y="308">0x7e</text>
                <text x="164" y="340">index=20</text>
                <text x="248" y="340">KID</text>
                <text x="272" y="340">=</text>
                <text x="304" y="340">0x14e</text>
                <text x="32" y="372">...</text>
              </g>
            </svg><a href="#section-5.2-8.1" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
</section>
</div>
<div id="media-considerations">
<section id="section-6">
      <h2 id="name-media-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-media-considerations" class="section-name selfRef">Media Considerations</a>
      </h2>
<div id="sfu">
<section id="section-6.1">
        <h3 id="name-sfu">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-sfu" class="section-name selfRef">SFU</a>
        </h3>
<p id="section-6.1-1">Selective Forwarding Units (SFUs) as described in <span><a href="https://rfc-editor.org/rfc/rfc7667#section-3.7" class="relref">Section 3.7</a> of [<a href="#RFC7667" class="cite xref">RFC7667</a>]</span>
receives the RTP streams from each participant and selects which ones should be
forwarded to each of the other participants.  There are several approaches about
how to do this stream selection but in general, in order to do so, the SFU needs
to access metadata associated to each frame and modify the RTP information of
the incoming packets when they are transmitted to the received participants.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">This section describes how this normal SFU modes of operation interacts with the
E2EE provided by SFrame<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<div id="lastn-and-rtp-stream-reuse">
<section id="section-6.1.1">
          <h4 id="name-lastn-and-rtp-stream-reuse">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-lastn-and-rtp-stream-reuse" class="section-name selfRef">LastN and RTP stream reuse</a>
          </h4>
<p id="section-6.1.1-1">The SFU may choose to send only a certain number of streams based on the voice
activity of the participants. To reduce the number of SDP O/A required to
establish a new RTP stream, the SFU may decide to reuse previously existing RTP
sessions or even pre-allocate a predefined number of RTP streams and choose in
each moment in time which participant media will be sending through it.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">This means that in the same RTP stream (defined by either SSRC or MID) may carry
media from different streams of different participants. As different keys are
used by each participant for encoding their media, the receiver will be able to
verify which is the sender of the media coming within the RTP stream at any
given point if time, preventing the SFU trying to impersonate any of the
participants with another participant's media.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1.1-3">Note that in order to prevent impersonation by a malicious participant (not the
SFU), a mechanism based on digital signature would be required. SFrame does not
protect against such attacks.<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="simulcast">
<section id="section-6.1.2">
          <h4 id="name-simulcast">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-simulcast" class="section-name selfRef">Simulcast</a>
          </h4>
<p id="section-6.1.2-1">When using simulcast, the same input image will produce N different encoded
frames (one per simulcast layer) which would be processed independently by the
frame encryptor and assigned an unique counter for each.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="svc">
<section id="section-6.1.3">
          <h4 id="name-svc">
<a href="#section-6.1.3" class="section-number selfRef">6.1.3. </a><a href="#name-svc" class="section-name selfRef">SVC</a>
          </h4>
<p id="section-6.1.3-1">In both temporal and spatial scalability, the SFU may choose to drop layers in
order to match a certain bitrate or forward specific media sizes or frames per
second. In order to support it, the sender MUST encode each spatial layer of a
given picture in a different frame. That is, an RTP frame may contain more than
one SFrame encrypted frame with an incrementing frame counter.<a href="#section-6.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="video-key-frames">
<section id="section-6.2">
        <h3 id="name-video-key-frames">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-video-key-frames" class="section-name selfRef">Video Key Frames</a>
        </h3>
<p id="section-6.2-1">Forward and Post-Compromise Security requires that the e2ee keys are updated
anytime a participant joins/leave the call.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The key exchange happens async and on a different path than the SFU signaling
and media. So it may happen that when a new participant joins the call and the
SFU side requests a key frame, the sender generates the e2ee encrypted frame
with a key not known by the receiver, so it will be discarded. When the sender
updates his sending key with the new key, it will send it in a non-key frame, so
the receiver will be able to decrypt it, but not decode it.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">Receiver will re-request an key frame then, but due to sender and sfu policies,
that new key frame could take some time to be generated.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">If the sender sends a key frame when the new e2ee key is in use, the time
required for the new participant to display the video is minimized.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="partial-decoding">
<section id="section-6.3">
        <h3 id="name-partial-decoding">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-partial-decoding" class="section-name selfRef">Partial Decoding</a>
        </h3>
<p id="section-6.3-1">Some codes support partial decoding, where it can decrypt individual packets
without waiting for the full frame to arrive, with SFrame this won't be possible
because the decoder will not access the packets until the entire frame is
arrived and decrypted.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="no-per-sender-authentication">
<section id="section-7.1">
        <h3 id="name-no-per-sender-authenticatio">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-no-per-sender-authenticatio" class="section-name selfRef">No Per-Sender Authentication</a>
        </h3>
<p id="section-7.1-1">SFrame does not provide per-sender authentication of media data.  Any sender in
a session can send media that will be associated with any other sender.  This is
because SFrame uses symmetric encryption to protect media data, so that any
receiver also has the keys required to encrypt packets for the sender.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-management-1">
<section id="section-7.2">
        <h3 id="name-key-management-2">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-key-management-2" class="section-name selfRef">Key Management</a>
        </h3>
<p id="section-7.2-1">Key exchange mechanism is out of scope of this document, however every client
MUST change their keys when new clients joins or leaves the call for "Forward
Secrecy" and "Post Compromise Security".<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-tag-length">
<section id="section-7.3">
        <h3 id="name-authentication-tag-length">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-authentication-tag-length" class="section-name selfRef">Authentication tag length</a>
        </h3>
<p id="section-7.3-1">The cipher suites defined in this draft use short authentication tags for
encryption, however it can easily support other ciphers with full authentication
tag if the short ones are proved insecure.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document makes no requests of IANA.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5116">[RFC5116]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refTitle">"An Interface and Algorithms for Authenticated Encryption"</span>, <span class="seriesInfo">RFC 5116</span>, <span class="seriesInfo">DOI 10.17487/RFC5116</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5116">https://www.rfc-editor.org/rfc/rfc5116</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5869">https://www.rfc-editor.org/rfc/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-mls-architecture">[I-D.ietf-mls-architecture]</dt>
        <dd>
<span class="refAuthor">Beurdouche, B.</span>, <span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Omara, E.</span>, <span class="refAuthor">Inguva, S.</span>, and <span class="refAuthor">A. Duric</span>, <span class="refTitle">"The Messaging Layer Security (MLS) Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-mls-architecture-10</span>, <time datetime="2022-12-16" class="refDate">16 December 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-mls-architecture-10">https://datatracker.ietf.org/doc/html/draft-ietf-mls-architecture-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-mls-protocol">[I-D.ietf-mls-protocol]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Beurdouche, B.</span>, <span class="refAuthor">Robert, R.</span>, <span class="refAuthor">Millican, J.</span>, <span class="refAuthor">Omara, E.</span>, and <span class="refAuthor">K. Cohn-Gordon</span>, <span class="refTitle">"The Messaging Layer Security (MLS) Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-mls-protocol-17</span>, <time datetime="2022-12-19" class="refDate">19 December 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-mls-protocol-17">https://datatracker.ietf.org/doc/html/draft-ietf-mls-protocol-17</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.murillo-perc-lite">[I-D.murillo-perc-lite]</dt>
        <dd>
<span class="refAuthor">Murillo, S. G.</span> and <span class="refAuthor">A. Gouaillard</span>, <span class="refTitle">"End to End Media Encryption Procedures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-murillo-perc-lite-01</span>, <time datetime="2020-05-12" class="refDate">12 May 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-murillo-perc-lite-01">https://datatracker.ietf.org/doc/html/draft-murillo-perc-lite-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3711">[RFC3711]</dt>
        <dd>
<span class="refAuthor">Baugher, M.</span>, <span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Naslund, M.</span>, <span class="refAuthor">Carrara, E.</span>, and <span class="refAuthor">K. Norrman</span>, <span class="refTitle">"The Secure Real-time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 3711</span>, <span class="seriesInfo">DOI 10.17487/RFC3711</span>, <time datetime="2004-03" class="refDate">March 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3711">https://www.rfc-editor.org/rfc/rfc3711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7667">[RFC7667]</dt>
        <dd>
<span class="refAuthor">Westerlund, M.</span> and <span class="refAuthor">S. Wenger</span>, <span class="refTitle">"RTP Topologies"</span>, <span class="seriesInfo">RFC 7667</span>, <span class="seriesInfo">DOI 10.17487/RFC7667</span>, <time datetime="2015-11" class="refDate">November 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7667">https://www.rfc-editor.org/rfc/rfc7667</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8723">[RFC8723]</dt>
        <dd>
<span class="refAuthor">Jennings, C.</span>, <span class="refAuthor">Jones, P.</span>, <span class="refAuthor">Barnes, R.</span>, and <span class="refAuthor">A.B. Roach</span>, <span class="refTitle">"Double Encryption Procedures for the Secure Real-Time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 8723</span>, <span class="seriesInfo">DOI 10.17487/RFC8723</span>, <time datetime="2020-04" class="refDate">April 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8723">https://www.rfc-editor.org/rfc/rfc8723</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TestVectors">[TestVectors]</dt>
      <dd>
<span class="refTitle">"SFrame Test Vectors"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://github.com/eomara/sframe/blob/master/test-vectors.json">https://github.com/eomara/sframe/blob/master/test-vectors.json</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">The authors wish to specially thank Dr. Alex Gouaillard as one of the early
contributors to the document. His passion and energy were key to the design and
development of SFrame.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overhead">
<section id="appendix-B">
      <h2 id="name-overhead">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-overhead" class="section-name selfRef">Overhead</a>
      </h2>
<p id="appendix-B-1">The encryption overhead will vary between audio and video streams, because in
audio each packet is considered a separate frame, so it will always have extra
MAC and IV, however a video frame usually consists of multiple RTP packets.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">The number of bytes overhead per frame is calculated as the following<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-3">
<pre>
1 + FrameCounter length + 4
</pre><a href="#appendix-B-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B-4">The constant 1 is the SFrame header byte and 4 bytes for the HBH authentication tag for both audio and video packets.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<div id="audio">
<section id="appendix-B.1">
        <h3 id="name-audio">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-audio" class="section-name selfRef">Audio</a>
        </h3>
<p id="appendix-B.1-1">Using three different audio frame durations<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.1-2.1">20ms (50 packets/s)<a href="#appendix-B.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.1-2.2">40ms (25 packets/s)<a href="#appendix-B.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.1-2.3">100ms (10 packets/s)<a href="#appendix-B.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-B.1-3">Up to 3 bytes frame counter (3.8 days of data for 20ms frame duration) and 4
bytes fixed MAC length.<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Counter len</th>
              <th class="text-center" rowspan="1" colspan="1">Packets</th>
              <th class="text-center" rowspan="1" colspan="1">Overhead</th>
              <th class="text-center" rowspan="1" colspan="1">Overhead</th>
              <th class="text-center" rowspan="1" colspan="1">Overhead</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1"> </td>
              <td class="text-center" rowspan="1" colspan="1"> </td>
              <td class="text-center" rowspan="1" colspan="1">bps@20ms</td>
              <td class="text-center" rowspan="1" colspan="1">bps@40ms</td>
              <td class="text-center" rowspan="1" colspan="1">bps@100ms</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">1</td>
              <td class="text-center" rowspan="1" colspan="1">0-255</td>
              <td class="text-center" rowspan="1" colspan="1">2400</td>
              <td class="text-center" rowspan="1" colspan="1">1200</td>
              <td class="text-center" rowspan="1" colspan="1">480</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">2</td>
              <td class="text-center" rowspan="1" colspan="1">255 - 65K</td>
              <td class="text-center" rowspan="1" colspan="1">2800</td>
              <td class="text-center" rowspan="1" colspan="1">1400</td>
              <td class="text-center" rowspan="1" colspan="1">560</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">3</td>
              <td class="text-center" rowspan="1" colspan="1">65K - 16M</td>
              <td class="text-center" rowspan="1" colspan="1">3200</td>
              <td class="text-center" rowspan="1" colspan="1">1600</td>
              <td class="text-center" rowspan="1" colspan="1">640</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="video">
<section id="appendix-B.2">
        <h3 id="name-video">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-video" class="section-name selfRef">Video</a>
        </h3>
<p id="appendix-B.2-1">The per-stream overhead bits per second as calculated for the following video
encodings:<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-2.1">30fps @ 1000Kbps (4 packets per frame)<a href="#appendix-B.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.2-2.2">30fps @ 512Kbps (2 packets per frame)<a href="#appendix-B.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.2-2.3">15fps @ 200Kbps (2 packets per frame)<a href="#appendix-B.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.2-2.4">7.5fps @ 30Kbps (1 packet per frame)<a href="#appendix-B.2-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-B.2-3">Overhead <code>bps = (Counter length + 1 + 4 ) * 8 * fps</code><a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
          <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Counter len</th>
              <th class="text-center" rowspan="1" colspan="1">Frames</th>
              <th class="text-center" rowspan="1" colspan="1">Overhead</th>
              <th class="text-center" rowspan="1" colspan="1">Overhead</th>
              <th class="text-center" rowspan="1" colspan="1">Overhead</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1"> </td>
              <td class="text-center" rowspan="1" colspan="1"> </td>
              <td class="text-center" rowspan="1" colspan="1">bps@30fps</td>
              <td class="text-center" rowspan="1" colspan="1">bps@15fps</td>
              <td class="text-center" rowspan="1" colspan="1">bps@7.5fps</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">1</td>
              <td class="text-center" rowspan="1" colspan="1">0-255</td>
              <td class="text-center" rowspan="1" colspan="1">1440</td>
              <td class="text-center" rowspan="1" colspan="1">1440</td>
              <td class="text-center" rowspan="1" colspan="1">720</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">2</td>
              <td class="text-center" rowspan="1" colspan="1">256 - 65K</td>
              <td class="text-center" rowspan="1" colspan="1">1680</td>
              <td class="text-center" rowspan="1" colspan="1">1680</td>
              <td class="text-center" rowspan="1" colspan="1">840</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">3</td>
              <td class="text-center" rowspan="1" colspan="1">56K - 16M</td>
              <td class="text-center" rowspan="1" colspan="1">1920</td>
              <td class="text-center" rowspan="1" colspan="1">1920</td>
              <td class="text-center" rowspan="1" colspan="1">960</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">4</td>
              <td class="text-center" rowspan="1" colspan="1">16M - 4B</td>
              <td class="text-center" rowspan="1" colspan="1">2160</td>
              <td class="text-center" rowspan="1" colspan="1">2160</td>
              <td class="text-center" rowspan="1" colspan="1">1080</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sframe-vs-perc-lite">
<section id="appendix-B.3">
        <h3 id="name-sframe-vs-perc-lite">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-sframe-vs-perc-lite" class="section-name selfRef">SFrame vs PERC-lite</a>
        </h3>
<p id="appendix-B.3-1"><span>[<a href="#RFC8723" class="cite xref">RFC8723</a>]</span> has significant overhead over SFrame because the overhead is per
packet, not per frame, and OHB (Original Header Block) which duplicates any RTP
header/extension field modified by the SFU.<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3-2"><span>[<a href="#I-D.murillo-perc-lite" class="cite xref">I-D.murillo-perc-lite</a>]</span>
          <span><a href="https://mailarchive.ietf.org/arch/msg/perc/SB0qMHWz6EsDtz3yIEX0HWp5IEY/">https://mailarchive.ietf.org/arch/msg/perc/SB0qMHWz6EsDtz3yIEX0HWp5IEY/</a></span> is
slightly better because it doesn’t use the OHB anymore, however it still does
per packet encryption using SRTP.<a href="#appendix-B.3-2" class="pilcrow">¶</a></p>
<p id="appendix-B.3-3">Below the the overheard in <span>[<a href="#I-D.murillo-perc-lite" class="cite xref">I-D.murillo-perc-lite</a>]</span> implemented by Cosmos
Software which uses extra 11 bytes per packet to preserve the <code>PT</code>, <code>SEQ_NUM</code>,
<code>TIME_STAMP</code> and <code>SSRC</code> fields in addition to the extra MAC tag per packet.<a href="#appendix-B.3-3" class="pilcrow">¶</a></p>
<p id="appendix-B.3-4"><code>
OverheadPerPacket = 11 + MAC length
Overhead bps = PacketPerSecond * OverHeadPerPacket * 8
</code><a href="#appendix-B.3-4" class="pilcrow">¶</a></p>
<p id="appendix-B.3-5">Similar to SFrame, we will assume the HBH authentication tag length will always
be 4 bytes for audio and video even though it is not the case in this
<span>[<a href="#I-D.murillo-perc-lite" class="cite xref">I-D.murillo-perc-lite</a>]</span> implementation<a href="#appendix-B.3-5" class="pilcrow">¶</a></p>
<div id="audio-1">
<section id="appendix-B.3.1">
          <h4 id="name-audio-2">
<a href="#appendix-B.3.1" class="section-number selfRef">B.3.1. </a><a href="#name-audio-2" class="section-name selfRef">Audio</a>
          </h4>
<table class="center" id="table-4">
            <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
              <tr>
                <th class="text-center" rowspan="1" colspan="1">Overhead bps@20ms</th>
                <th class="text-center" rowspan="1" colspan="1">Overhead  bps@40ms</th>
                <th class="text-center" rowspan="1" colspan="1">Overhead bps@100ms</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">6000</td>
                <td class="text-center" rowspan="1" colspan="1">3000</td>
                <td class="text-center" rowspan="1" colspan="1">1200</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="video-1">
<section id="appendix-B.3.2">
          <h4 id="name-video-2">
<a href="#appendix-B.3.2" class="section-number selfRef">B.3.2. </a><a href="#name-video-2" class="section-name selfRef">Video</a>
          </h4>
<table class="center" id="table-5">
            <caption><a href="#table-5" class="selfRef">Table 5</a></caption>
<thead>
              <tr>
                <th class="text-center" rowspan="1" colspan="1">Overhead  bps@30fps</th>
                <th class="text-center" rowspan="1" colspan="1">Overhead  bps@15fps</th>
                <th class="text-center" rowspan="1" colspan="1">Overhead  bps@7.5fps</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">(4 packets per frame)</td>
                <td class="text-center" rowspan="1" colspan="1">(2 packets per frame)</td>
                <td class="text-center" rowspan="1" colspan="1">(1 packet per frame)</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">14400</td>
                <td class="text-center" rowspan="1" colspan="1">7200</td>
                <td class="text-center" rowspan="1" colspan="1">3600</td>
              </tr>
            </tbody>
          </table>
<p id="appendix-B.3.2-2">For a conference with a single incoming audio stream (@ 50 pps) and 4 incoming
video streams (@200 Kbps), the savings in overhead is 34800 - 9600 = ~25 Kbps,
or ~3%.<a href="#appendix-B.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="test-vectors">
<section id="appendix-C">
      <h2 id="name-test-vectors">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="appendix-C-1">This section provides a set of test vectors that implementations can use to
verify that they correctly implement SFrame encryption and decryption.  For each
ciphersuite, we provide:<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1">[in] The <code>base_key</code> value (hex encoded)<a href="#appendix-C-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-C-2.2">[out] The <code>secret</code>, <code>key</code>, and <code>salt</code> values derived from the <code>base_key</code> (hex
encoded)<a href="#appendix-C-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-C-2.3">A plaintext value that is encrypted in the following encryption cases<a href="#appendix-C-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-C-2.4">
          <p id="appendix-C-2.4.1">A sequence of encryption cases, including:<a href="#appendix-C-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.4.2.1">[in] The <code>KID</code> and <code>CTR</code> values to be included in the header<a href="#appendix-C-2.4.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-C-2.4.2.2">[out] The resulting encoded header (hex encoded)<a href="#appendix-C-2.4.2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-C-2.4.2.3">[out] The nonce computed from the <code>salt</code> and <code>CTR</code> values<a href="#appendix-C-2.4.2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-C-2.4.2.4">The ciphertext resulting from encrypting the plaintext with these parameters
(hex encoded)<a href="#appendix-C-2.4.2.4" class="pilcrow">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="appendix-C-3">An implementation should reproduce the output values given the input values:<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1">An implementation should be able to encrypt with the input values and the
plaintext to produce the ciphertext.<a href="#appendix-C-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-C-4.2">An implementation must be able to decrypt with the input values and the
ciphertext to generate the plaintext.<a href="#appendix-C-4.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-C-5">Line breaks and whitespace within values are inserted to conform to the width
requirements of the RFC format.  They should be removed before use.
These test vectors are also available in JSON format at <span>[<a href="#TestVectors" class="cite xref">TestVectors</a>]</span>.<a href="#appendix-C-5" class="pilcrow">¶</a></p>
<div id="aesctr128hmacsha2564">
<section id="appendix-C.1">
        <h3 id="name-aes_ctr_128_hmac_sha256_4">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-aes_ctr_128_hmac_sha256_4" class="section-name selfRef">AES_CTR_128_HMAC_SHA256_4</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-C.1-1">
<pre>
CipherSuite:    0x01
Base Key:       101112131415161718191a1b1c1d1e1f
Key:            343d3290f5c0b936415bea9a43c6f5a2
Salt:           42d662fbad5cd81eb3aad79a
Plaintext:      46726f6d2068656176656e6c79206861
                726d6f6e79202f2f205468697320756e
                6976657273616c206672616d65206265
                67616e
</pre><a href="#appendix-C.1-1" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.1-2">
<pre>
KID:            0x7
CTR:            0x0
Header:         1700
Nonce:          42d662fbad5cd81eb3aad79a
Ciphertext:     1700c5095af9dbbbed6a952de114ea7b
                42768509f1ffc9749abb1e95bf4514d8
                d82a0eef4b5ecac16fa193977fa1aa1c
                9fa5c7e73093ab2a43
</pre><a href="#appendix-C.1-2" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.1-3">
<pre>
KID:            0x7
CTR:            0x1
Header:         1701
Nonce:          42d662fbad5cd81eb3aad79b
Ciphertext:     1701559e262525382885c6c93be8f61a
                9064db2dd1e1e96ab1dbd829ca4af4f4
                5f2b97a4889217a3f8a2159fb8201b7d
                71db01702bd4bab5c7
</pre><a href="#appendix-C.1-3" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.1-4">
<pre>
KID:            0x7
CTR:            0x2
Header:         1702
Nonce:          42d662fbad5cd81eb3aad798
Ciphertext:     17020a8f21e052eaa09e50da0a909d15
                6cc55b9ef2f2abbcca765f7af3cfb1af
                234e3eac1dbc376631c83cf1ff1f8ab3
                39dbc41044cc930d87
</pre><a href="#appendix-C.1-4" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.1-5">
<pre>
KID:            0xf
CTR:            0xaa
Header:         190faa
Nonce:          42d662fbad5cd81eb3aad730
Ciphertext:     190faa9c65aa5b167873f25827f17bc3
                4879a4aaa6b38dd9584472e1849d5da5
                1555f288d08f03166a5f26af01794006
                255c88b58986246287c9
</pre><a href="#appendix-C.1-5" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.1-6">
<pre>
KID:            0x1ff
CTR:            0xaa
Header:         1a01ffaa
Nonce:          42d662fbad5cd81eb3aad730
Ciphertext:     1a01ffaa9c65aa5b167873f25827f17b
                c34879a4aaa6b38dd9584472e1849d5d
                a51555f288d08f03166a5f26af017940
                06255c88b589863003872e
</pre><a href="#appendix-C.1-6" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.1-7">
<pre>
KID:            0x1ff
CTR:            0xaaaa
Header:         2a01ffaaaa
Nonce:          42d662fbad5cd81eb3aa7d30
Ciphertext:     2a01ffaaaa990cbeb4ae2e3a76be8bb9
                54b62591e791d0fa53c0553bc1d1e021
                d270b1a10688cd89195203b019789253
                73b04f9c08c3a4e5fb0173ef
</pre><a href="#appendix-C.1-7" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.1-8">
<pre>
KID:            0xffffffffffffff
CTR:            0xffffffffffffff
Header:         7fffffffffffffffffffffffffffff
Nonce:          42d662fbada327e14c552865
Ciphertext:     7fffffffffffffffffffffffffffff41
                2c43c8077c286f7df3dd9988d1bd033f
                1067493e09421e5bfc363e50a3c803b4
                da9239514cb924dbcb5f33e33112083e
                99103ef272e8
</pre><a href="#appendix-C.1-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="aesctr128hmacsha2568">
<section id="appendix-C.2">
        <h3 id="name-aes_ctr_128_hmac_sha256_8">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-aes_ctr_128_hmac_sha256_8" class="section-name selfRef">AES_CTR_128_HMAC_SHA256_8</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-C.2-1">
<pre>
CipherSuite:    0x02
Base Key:       202122232425262728292a2b2c2d2e2f
Key:            3fce747d505e46ec9b92d9f58ee7a5d4
Salt:           77fbf5f1d82c73f6d2b353c9
Plaintext:      46726f6d2068656176656e6c79206861
                726d6f6e79202f2f205468697320756e
                6976657273616c206672616d65206265
                67616e
</pre><a href="#appendix-C.2-1" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.2-2">
<pre>
KID:            0x7
CTR:            0x0
Header:         1700
Nonce:          77fbf5f1d82c73f6d2b353c9
Ciphertext:     17009d89e5753e06edf3025f1ccd70b0
                95ebaf10c250e11da740f50f57b6ce86
                0d7321dfa49688a2cd6c6d9a71ae9d5c
                14ad0978efe0216ae5f6788ffe
</pre><a href="#appendix-C.2-2" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.2-3">
<pre>
KID:            0x7
CTR:            0x1
Header:         1701
Nonce:          77fbf5f1d82c73f6d2b353c8
Ciphertext:     1701becd2e9d10e3eed586491b3e0ece
                dba89407ae2151787c5117b55707d6b8
                a0754f4dc937e30ebdf7cafbd3769d65
                85d7991b1aa6f36e418fdec6fa
</pre><a href="#appendix-C.2-3" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.2-4">
<pre>
KID:            0x7
CTR:            0x2
Header:         1702
Nonce:          77fbf5f1d82c73f6d2b353cb
Ciphertext:     170298508be6b16d034f15b504ced45a
                86d1bb43ed7cd3a62bf25557d1b082b0
                4e8e6ba6fe76160835dd8953e1be9640
                c988627ea4f1bb846e87523f8b
</pre><a href="#appendix-C.2-4" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.2-5">
<pre>
KID:            0xf
CTR:            0xaa
Header:         190faa
Nonce:          77fbf5f1d82c73f6d2b35363
Ciphertext:     190faae7eec4b0556ddfb8068998351c
                d670ce95f0ce9cd4c6dca2eeee73fb14
                d20a0d0fd487337ed43fa7f98dad0995
                b8b870325aa349ac0590c2745d5d
</pre><a href="#appendix-C.2-5" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.2-6">
<pre>
KID:            0x1ff
CTR:            0xaa
Header:         1a01ffaa
Nonce:          77fbf5f1d82c73f6d2b35363
Ciphertext:     1a01ffaae7eec4b0556ddfb806899835
                1cd670ce95f0ce9cd4c6dca2eeee73fb
                14d20a0d0fd487337ed43fa7f98dad09
                95b8b870325aa31d576e8a34093320
</pre><a href="#appendix-C.2-6" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.2-7">
<pre>
KID:            0x1ff
CTR:            0xaaaa
Header:         2a01ffaaaa
Nonce:          77fbf5f1d82c73f6d2b3f963
Ciphertext:     2a01ffaaaa8c1789aa0abcd6abc27006
                aae4df5cba4ba07f8113080e9726baac
                d16c18539974a6204a36b9dc3dcd36ed
                9ab48e590d95d4ad1b05f8375508c55d
</pre><a href="#appendix-C.2-7" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.2-8">
<pre>
KID:            0xffffffffffffff
CTR:            0xffffffffffffff
Header:         7fffffffffffffffffffffffffffff
Nonce:          77fbf5f1d8d38c092d4cac36
Ciphertext:     7fffffffffffffffffffffffffffffa9
                bc6c7edde0fdfd13255a5b145c5ce84d
                b8f8960858eb998b8ea8f3e770160150
                813c5806441b64251bdd2be9e8cec138
                6b6f5e73eaa6c19e6555
</pre><a href="#appendix-C.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="aesgcm128sha256">
<section id="appendix-C.3">
        <h3 id="name-aes_gcm_128_sha256">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-aes_gcm_128_sha256" class="section-name selfRef">AES_GCM_128_SHA256</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-C.3-1">
<pre>
CipherSuite:    0x03
Base Key:       303132333435363738393a3b3c3d3e3f
Key:            2ea2e8163ff56c0613e6fa9f20a213da
Salt:           a80478b3f6fba19983d540d5
Plaintext:      46726f6d2068656176656e6c79206861
                726d6f6e79202f2f205468697320756e
                6976657273616c206672616d65206265
                67616e
</pre><a href="#appendix-C.3-1" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.3-2">
<pre>
KID:            0x7
CTR:            0x0
Header:         1700
Nonce:          a80478b3f6fba19983d540d5
Ciphertext:     17000e426255e47ed70dd7d15d69d759
                bf459032ca15f5e8b2a91e7d348aa7c1
                86d403f620801c495b1717a35097411a
                a97cbb140671eb3b49ac3775926db74d
                57b91e8e6c
</pre><a href="#appendix-C.3-2" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.3-3">
<pre>
KID:            0x7
CTR:            0x1
Header:         1701
Nonce:          a80478b3f6fba19983d540d4
Ciphertext:     170103bbafa34ada8a6b9f2066bc34a1
                959d87384c9f4b1ce34fed58e938bde1
                43393910b1aeb55b48d91d5b0db3ea67
                e3d0e02b843afd41630c940b1948e72d
                d45396a43a
</pre><a href="#appendix-C.3-3" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.3-4">
<pre>
KID:            0x7
CTR:            0x2
Header:         1702
Nonce:          a80478b3f6fba19983d540d7
Ciphertext:     170258d58adebd8bf6f3cc0c1fcacf34
                ba4d7a763b2683fe302a57f1be7f2a27
                4bf81b2236995fec1203cadb146cd402
                e1c52d5e6a10989dfe0f4116da1ee4c2
                fad0d21f8f
</pre><a href="#appendix-C.3-4" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.3-5">
<pre>
KID:            0xf
CTR:            0xaa
Header:         190faa
Nonce:          a80478b3f6fba19983d5407f
Ciphertext:     190faad0b1743bf5248f90869c945636
                6d55724d16bbe08060875815565e90b1
                14f9ccbdba192422b33848a1ae1e3bd2
                66a001b2f5bb727112772e0072ea8679
                ca1850cf11d8
</pre><a href="#appendix-C.3-5" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.3-6">
<pre>
KID:            0x1ff
CTR:            0xaa
Header:         1a01ffaa
Nonce:          a80478b3f6fba19983d5407f
Ciphertext:     1a01ffaad0b1743bf5248f90869c9456
                366d55724d16bbe08060875815565e90
                b114f9ccbdba192422b33848a1ae1e3b
                d266a001b2f5bbc9c63bd3973c19bd57
                127f565380ed4a
</pre><a href="#appendix-C.3-6" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.3-7">
<pre>
KID:            0x1ff
CTR:            0xaaaa
Header:         2a01ffaaaa
Nonce:          a80478b3f6fba19983d5ea7f
Ciphertext:     2a01ffaaaa9de65e21e4f1ca2247b879
                43c03c5cb7b182090e93d508dcfb76e0
                8174c6397356e682d2eaddabc0b3c101
                8d2c13c3570f61c1beaab805f27b565e
                1329a823a7a649b6
</pre><a href="#appendix-C.3-7" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.3-8">
<pre>
KID:            0xffffffffffffff
CTR:            0xffffffffffffff
Header:         7fffffffffffffffffffffffffffff
Nonce:          a80478b3f6045e667c2abf2a
Ciphertext:     7fffffffffffffffffffffffffffff09
                981bdcdad80e380b6f74cf6afdbce946
                839bedadd57578bfcd809dbcea535546
                cc24660613d2761adea852155785011e
                633534f4ecc3b8257c8d34321c27854a
                1422
</pre><a href="#appendix-C.3-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="aesgcm256sha512">
<section id="appendix-C.4">
        <h3 id="name-aes_gcm_256_sha512">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-aes_gcm_256_sha512" class="section-name selfRef">AES_GCM_256_SHA512</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-C.4-1">
<pre>
CipherSuite:    0x04
Base Key:       404142434445464748494a4b4c4d4e4f
                505152535455565758595a5b5c5d5e5f
Key:            436774b0b5ae45633d96547f8f3cb06c
                8e6628eff2e4255b5c4d77e721aa3355
Salt:           31ed26f90a072e6aee646298
Plaintext:      46726f6d2068656176656e6c79206861
                726d6f6e79202f2f205468697320756e
                6976657273616c206672616d65206265
                67616e
</pre><a href="#appendix-C.4-1" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.4-2">
<pre>
KID:            0x7
CTR:            0x0
Header:         1700
Nonce:          31ed26f90a072e6aee646298
Ciphertext:     1700f3e297c1e95207710bd31ccc4ba3
                96fbef7b257440bde638ff0f3c891154
                0136df61b26220249d6c432c245ae8d5
                5ef45bfccf32530a15aeaaf313a03838
                e51bd45652
</pre><a href="#appendix-C.4-2" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.4-3">
<pre>
KID:            0x7
CTR:            0x1
Header:         1701
Nonce:          31ed26f90a072e6aee646299
Ciphertext:     170193268b0bf030071bff443bb6b447
                1bdfb1cc81bc9625f4697b0336ff4665
                d15f152f02169448d8a967fb06359a87
                d2145398de0ce3fbe257b0992a3da153
                7590459f3c
</pre><a href="#appendix-C.4-3" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.4-4">
<pre>
KID:            0x7
CTR:            0x2
Header:         1702
Nonce:          31ed26f90a072e6aee64629a
Ciphertext:     1702649691ba27c4c01a41280fba4657
                c03fa7fe21c8f5c862e9094227c3ca3e
                c0d9468b1a2cb060ff0978f25a24e6b1
                06f5a6e1053c1b8f5fce794d88a0e481
                8c081e18ea
</pre><a href="#appendix-C.4-4" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.4-5">
<pre>
KID:            0xf
CTR:            0xaa
Header:         190faa
Nonce:          31ed26f90a072e6aee646232
Ciphertext:     190faa2858c10b5ddd231c1f26819490
                521678603a050448d563c503b1fd890d
                02ead01d754f074ecb6f32da9b2f3859
                f380b4f47d4edd1e15f42f9a2d7ecfac
                99067e238321
</pre><a href="#appendix-C.4-5" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.4-6">
<pre>
KID:            0x1ff
CTR:            0xaa
Header:         1a01ffaa
Nonce:          31ed26f90a072e6aee646232
Ciphertext:     1a01ffaa2858c10b5ddd231c1f268194
                90521678603a050448d563c503b1fd89
                0d02ead01d754f074ecb6f32da9b2f38
                59f380b4f47d4e3bf7040eb10ec25b81
                26b2ce7b1d9d31
</pre><a href="#appendix-C.4-6" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.4-7">
<pre>
KID:            0x1ff
CTR:            0xaaaa
Header:         2a01ffaaaa
Nonce:          31ed26f90a072e6aee64c832
Ciphertext:     2a01ffaaaad9bc6a258a07d210a814d5
                45eca70321c0e87498ada6e5c708b7ea
                d162ffcf4fbaba1eb82650590a87122b
                4d95fe36bd88b278812166d26e046ed0
                a530b7ee232ee0f2
</pre><a href="#appendix-C.4-7" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-C.4-8">
<pre>
KID:            0xffffffffffffff
CTR:            0xffffffffffffff
Header:         7fffffffffffffffffffffffffffff
Nonce:          31ed26f90af8d195119b9d67
Ciphertext:     7fffffffffffffffffffffffffffffaf
                480d4779ce0c02b5137ee6a61e026c04
                ac999cb0c97319feceeb258d58df23bc
                e14979e5c67a431777b34498062e72f9
                39ca42ec84ffbc7b50eff923f515a2df
                760c
</pre><a href="#appendix-C.4-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Emad Omara</span></div>
<div dir="auto" class="left"><span class="org">Apple</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:eomara@apple.com" class="email">eomara@apple.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Justin Uberti</span></div>
<div dir="auto" class="left"><span class="org">Google</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:juberti@google.com" class="email">juberti@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Sergio Garcia Murillo</span></div>
<div dir="auto" class="left"><span class="org">CoSMo Software</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sergio.garcia.murillo@cosmosoftware.io" class="email">sergio.garcia.murillo@cosmosoftware.io</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Richard L. Barnes (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rlb@ipv.sx" class="email">rlb@ipv.sx</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Youenn Fablet</span></div>
<div dir="auto" class="left"><span class="org">Apple</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:youenn@apple.com" class="email">youenn@apple.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
